## 2024-07-16 - Webhook Signature Verification Bypass
**Vulnerability:** A "fail-open" vulnerability was identified in the `payment-webhook` Supabase function. If the `LENCO_WEBHOOK_SECRET` environment variable was not set, the webhook signature verification was completely bypassed.
**Learning:** This permissive fallback, likely intended for development, creates a critical security hole in production. It allows an attacker to send unverified, spoofed webhook events to the server, potentially granting unauthorized access to paid features by simulating successful payments. The root cause was a conditional check that returned `true` (valid) if the secret was missing, rather than `false` (invalid).
**Prevention:** All security checks, especially signature verification, must follow a "fail-secure" or "default-deny" principle. The absence of a required secret must always result in a verification failure, never a bypass. Environment-specific logic should be handled with extreme care, and production environments must be strictly configured to enforce all security controls.